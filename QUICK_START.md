# VaultSafe åŒæ­¥æœåŠ¡å™¨ - å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ä¸€ã€å®‰è£…ä¾èµ–

```bash
pip install -r requirements-server.txt
```

æˆ–æ‰‹åŠ¨å®‰è£…ï¼š
```bash
pip install flask flask-cors
```

## äºŒã€å¯åŠ¨æœåŠ¡å™¨

### Windows ç”¨æˆ·ï¼ˆæœ€ç®€å•ï¼‰
ç›´æ¥åŒå‡»è¿è¡Œ `start_server.bat`

### å‘½ä»¤è¡Œå¯åŠ¨
```bash
python sync_server.py
```

### å¯åŠ¨åè¾“å‡ºç¤ºä¾‹
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            VaultSafe åŒæ­¥æœåŠ¡å™¨                          â•‘
â•‘                                                            â•‘
â•‘  å¤šé…ç½®æ”¯æŒ - ä¸åŒé…ç½®åç§°å¯¹åº”ä¸åŒçš„æ•°æ®æ–‡ä»¶            â•‘
â•‘                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ æ•°æ®ç›®å½•: D:\vaultsafe_sync_data
ğŸŒ åŒæ­¥ç«¯ç‚¹: http://localhost:5000/sync/<é…ç½®å>
   ç¤ºä¾‹: http://localhost:5000/sync/default
        http://localhost:5000/sync/work
        http://localhost:5000/sync/personal
ğŸ“Š çŠ¶æ€æŸ¥è¯¢: http://localhost:5000/status
ğŸ—‘ï¸  æ¸…é™¤é…ç½®: POST http://localhost:5000/clear/<é…ç½®å>

å¯åŠ¨æœåŠ¡å™¨...
 * Running on http://0.0.0.0:5000
```

## ä¸‰ã€å¤šé…ç½®åŠŸèƒ½

### ä»€ä¹ˆæ˜¯å¤šé…ç½®ï¼Ÿ
æœåŠ¡å™¨æ”¯æŒå¤šä¸ªç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ï¼Œæ¯ä¸ªé…ç½®å¯¹åº”ä¸åŒçš„æ•°æ®æ–‡ä»¶ï¼š
- `default` â†’ `sync_data/default.json`
- `work` â†’ `sync_data/work.json`
- `personal` â†’ `sync_data/personal.json`

### ä½¿ç”¨åœºæ™¯
- **å·¥ä½œ/ä¸ªäººåˆ†ç¦»**ï¼šå·¥ä½œå¯†ç å’Œä¸ªäººå¯†ç åˆ†å¼€å­˜å‚¨
- **å¤šè®¾å¤‡åˆ†ç¦»**ï¼šä¸åŒè®¾å¤‡ä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶
- **æµ‹è¯•ç¯å¢ƒ**ï¼šæµ‹è¯•æ•°æ®ä¸å½±å“ç”Ÿäº§æ•°æ®

## å››ã€åœ¨ VaultSafe ä¸­é…ç½®

1. æ‰“å¼€ VaultSafe
2. è¿›å…¥ã€ŒåŒæ­¥ã€æ ‡ç­¾é¡µ
3. ç‚¹å‡»ã€Œé…ç½®ã€æŒ‰é’®
4. å¡«å†™æœåŠ¡å™¨åœ°å€ï¼Œæ ¼å¼ï¼š**`http://localhost:5000/sync/é…ç½®å`**
   - é»˜è®¤é…ç½®ï¼š`http://localhost:5000/sync/default`
   - å·¥ä½œé…ç½®ï¼š`http://localhost:5000/sync/work`
   - ä¸ªäººé…ç½®ï¼š`http://localhost:5000/sync/personal`
5. é€‰æ‹©è®¤è¯æ–¹å¼ï¼ˆå¦‚æœè®¾ç½®äº†ï¼‰
6. ç‚¹å‡»ã€Œæµ‹è¯•è¿æ¥ã€
7. ä¿å­˜é…ç½®
8. ç‚¹å‡»ã€Œä¸Šä¼ ã€ä¸Šä¼ æ•°æ®

### æ·»åŠ å¤šä¸ªåŒæ­¥é…ç½®

æ‚¨å¯ä»¥åœ¨ VaultSafe ä¸­æ·»åŠ å¤šä¸ªåŒæ­¥é…ç½®ï¼š

1. ç‚¹å‡»ã€Œé…ç½®ã€â†’ã€Œæ·»åŠ åŒæ­¥é…ç½®ã€
2. ä¸ºæ¯ä¸ªé…ç½®å¡«å†™ä¸åŒçš„æœåŠ¡å™¨åœ°å€ï¼š
   - é…ç½®1ï¼š`http://localhost:5000/sync/default`
   - é…ç½®2ï¼š`http://localhost:5000/sync/work`
   - é…ç½®3ï¼š`http://localhost:5000/sync/personal`

æ¯ä¸ªé…ç½®å¯ä»¥ä½¿ç”¨ä¸åŒçš„ä¸»å¯†ç åŠ å¯†ï¼

## äº”ã€æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€

è®¿é—®çŠ¶æ€é¡µé¢æŸ¥çœ‹æ‰€æœ‰é…ç½®ï¼š
```
http://localhost:5000/status
```

è¿”å›ç¤ºä¾‹ï¼š
```json
{
  "status": "running",
  "data_dir": "/path/to/sync_data",
  "total_configs": 3,
  "configs": [
    {
      "name": "default",
      "last_updated": "2024-01-01T12:00:00.000Z",
      "has_data": true,
      "devices": ["device-1", "device-2"]
    },
    {
      "name": "work",
      "last_updated": "2024-01-01T10:00:00.000Z",
      "has_data": true,
      "devices": ["device-3"]
    },
    {
      "name": "personal",
      "last_updated": "2024-01-01T08:00:00.000Z",
      "has_data": true,
      "devices": ["device-1"]
    }
  ]
}
```

## å…­ã€API ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/sync/<é…ç½®å>` | POST | ä¸Šä¼ æ•°æ®åˆ°æŒ‡å®šé…ç½® |
| `/sync/<é…ç½®å>` | GET | ä»æŒ‡å®šé…ç½®ä¸‹è½½æ•°æ® |
| `/status` | GET | æŸ¥çœ‹æ‰€æœ‰é…ç½®çŠ¶æ€ |
| `/clear/<é…ç½®å>` | POST | æ¸…é™¤æŒ‡å®šé…ç½® |
| `/clear` | POST | æ¸…é™¤æ‰€æœ‰é…ç½® |

## ä¸ƒã€æ·»åŠ è®¤è¯ï¼ˆæ¨èï¼‰

### Windows - ä¿®æ”¹ start_server.bat
ç¼–è¾‘ `start_server.bat`ï¼Œæ‰¾åˆ°é…ç½®åŒºåŸŸï¼š
```batch
REM Bearer Token è®¤è¯
set TOKEN=your-secret-token-here
```

### Linux/Mac - ä½¿ç”¨ç¯å¢ƒå˜é‡
```bash
export VAULTSAFE_API_TOKEN="your-secret-token-here"
python sync_server.py
```

### é…ç½®è‡ªå®šä¹‰æ•°æ®ç›®å½•
```bash
export VAULTSAFE_DATA_DIR="/path/to/data"
python sync_server.py
```

## å…«ã€æ•°æ®æ–‡ä»¶ç»“æ„

æ•°æ®ä¿å­˜åœ¨ `sync_data` ç›®å½•ä¸­ï¼Œæ¯ä¸ªé…ç½®å¯¹åº”ä¸€ä¸ª JSON æ–‡ä»¶ï¼š

**sync_data/default.json:**
```json
{
  "config_name": "default",
  "data": {
    "nonce": "device-id",
    "encrypted": true,
    "version": "1.0",
    "exportedAt": "2024-01-01T00:00:00.000Z",
    "checksum": "abc123..."
  },
  "last_updated": "2024-01-01T12:00:00.000Z",
  "device_info": {
    "device-1": {
      "last_upload": "2024-01-01T12:00:00.000Z",
      "timestamp": 1704067200
    }
  }
}
```

## ä¹ã€æµ‹è¯•æœåŠ¡å™¨

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½ï¼š
```bash
python test_server.py
```

æµ‹è¯•è„šæœ¬ä¼šï¼š
1. æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
2. æµ‹è¯•æ•°æ®ä¸Šä¼ 
3. æµ‹è¯•æ•°æ®ä¸‹è½½
4. æµ‹è¯•å¤šé…ç½®åŠŸèƒ½

## åã€é…ç½®åç§°è§„åˆ™

é…ç½®åç§°åªèƒ½åŒ…å«ï¼š
- å­—æ¯ï¼ˆa-z, A-Zï¼‰
- æ•°å­—ï¼ˆ0-9ï¼‰
- ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰
- è¿å­—ç¬¦ï¼ˆ-ï¼‰

æœ‰æ•ˆç¤ºä¾‹ï¼š
- âœ… `default`
- âœ… `work`
- âœ… `personal`
- âœ… `my_config_1`
- âœ… `test-2024`

æ— æ•ˆç¤ºä¾‹ï¼š
- âŒ `../etc/passwd`ï¼ˆè·¯å¾„éå†æ”»å‡»ï¼‰
- âŒ `config.json`ï¼ˆåŒ…å«åç¼€ï¼‰
- âŒ `my config`ï¼ˆåŒ…å«ç©ºæ ¼ï¼‰
- âŒ `config/backup`ï¼ˆåŒ…å«è·¯å¾„ï¼‰

## åä¸€ã€æ•…éšœæ’é™¤

### ç«¯å£è¢«å ç”¨
ä¿®æ”¹ `start_server.bat` ä¸­çš„ç«¯å£ï¼š
```batch
set PORT=8080
```

### é…ç½®åç§°æ— æ•ˆ
ç¡®ä¿é…ç½®åç§°åªåŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’Œè¿å­—ç¬¦ã€‚

### è¿æ¥è¢«æ‹’ç»
1. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
3. ç¡®è®¤ç«¯å£å·å’Œé…ç½®åç§°æ­£ç¡®
